packagecom.skwangles;importjava.util.ArrayList;importjava.util.Objects;//AlexanderStokes-1578409&RowanThorley-1560315//AlexanderDevelopedthis//--Factorisaliteral,termissomethingthatcouldbepartofawholei.e.abisatermofab/2//--StateorFSMmeansalabellediteminanFSMtablethathas1.astate,2.twonextstates-n1,n2-pointstothenextindexinthewholemodelpublicclassREcompile{intcurrstate=0;//Statenumberstartsat0,intnextChar=0;charregexpattern;//Holdsallthecharstobeparsed/compiledArrayList<State>FSMlist=newArrayList<>;StringspecialChars=;//AllspecialcharsStringwildcardPrintoStringbranchStatePrintout=;publicstaticvoidmainStringargs{Stringregex=args0;//Readsintheregexpatternintoaneasilyparse-ableset.REcompilecompile=newREcompile;compile.parseregex;}publicvoidparseStringregex{regexpattern=changeSquareToSlashregex.toCharArray;addState'\0',1,1;//Startingstateexpression;ifnextChar<regexpattern.lengtherror;//WholepatternwasnotparsedaddState'\0',-1,-1;//Finishingstatepointingbacktostart-Canberemoveorpointedto-1
forinti=0;i<FSMlist.size;i{Statestate=FSMlist.geti;System.out.printlnistate.n1state.n2state.symbol=='\0'?branchStatePrintout:state.symbol=='\t'?wildcardPrintout:state.symbol;}}publicbooleanisBracketSlashedintb,Stringregex{intevenOrOdd=0;whileb>0&&regex.charAtb-1=='\\'{evenOrOdd;b--;}returnevenOrOdd%2==1;//Ifodd,thereisa\forthe,ifeven-alltheslashescanceleachother}publicStringchangeSquareToSlashStringregex{//replacestheinaregexwiththeabcversionintfromIndex=0;whileregex.indexOf,fromIndex!=-1{intfirstBracket=regex.indexOf,fromIndex;ifisBracketSlashedfirstBracket,regex{fromIndex=firstBracket1;continue;}//Iftheisinterpretedasaliteral,skipitandadvancethe'searchfrom'indexintclosingBracket=regex.indexOf,fromIndex2;//Startsearchfromatleast2pastthetoexcludethefirstliteralCouldbeaifclosingBracket==-1closingBracket-firstBracket<=1{//Theremustbeaotherwisethereareunmatchedbracketsandtheremustbeatleast2characterstobevaliderror;}fromIndex=closingBracket;//Narrowthesearchregex=regex.substring0,firstBracketcutregex.substringclosingBracket1;//Readformattedstringbacktoinput}returnregex;}////-----------------PARSEFUNCTIONS-----------//publicintexpression{intprevState=currstate-1;intstartofExpression=concatenation;ifnextChar>=regexpattern.lengthreturnstartofExpression;//ReturniffinishedifregexpatternnextChar==''{nextChar;//ConsumeifnextChar>=regexpattern.length!isVocabregexpatternnextChar&&regexpatternnextChar!='.'&&regexpatternnextChar!=''error;//MakesureafullexpressionispossiblepointStateToCurrentprevState;//PointprevioustothebranchstateabouttobecreatedintheldBranch=currstate;addBranchState0,0;//placeholderintnextExpressionStart=expression;repointAllToCurrentheldBranch,prevState1;//RepointallitemspointingtoheldexcludingprevstateupdateStateheldBranch,'\0',startofExpression,nextExpressionStart;//pointStateToCurrentheldBranch-1;//PointstatejustBEFOREthebranchtotheexitstatestartofExpression=heldBranch;//Branchisnowthestartofthisexpression}returnstartofExpression;//Returnsthepointertothestartofthisparticularexpression}publicintconcatenation{intstartOfConcat=term;ifnextChar>=regexpattern.lengthreturnstartOfConcat;//Returniffinishedif!specialChars.containsregexpatternnextCharregexpatternnextChar==''regexpatternnextChar=='.'concatenation;//Lookahead,withoutadvancinganypossiblereturnstartOfConcat;}publicintterm{//nextCharisusedto'consume'theoperator//currstateisusedtoprogressforwardintheStatestableintprevState=currstate-1;intstartOfTermNumber=factor;ifnextChar>=regexpattern.lengthreturnstartOfTermNumber;ifregexpatternnextChar=='*'{pointStateToCurrentprevState;//repointtobranchstateaddBranchStatestartOfTermNumber,currstate1;//Addbranchstate,pointingtotheterm,andtotheitempastitt1alreadyispointingtothisbranchnextChar;startOfTermNumber=currstate-1;//BranchisnowthestartoftheTerm}elseifregexpatternnextChar=='?'{pointStateToCurrentprevState;//pointprevioustothenewbranchstateaddBranchStatestartOfTermNumber,currstate1;//Addbranchstate,pointingtotheterm,andtotheitempastitnextChar;repointAllToCurrentcurrstate-1,prevState1;//RepointanyitemsEXCLUDINGtheprevstate,tothenewexit}elseifregexpatternnextChar==''{//aisequaltoaa*-firstcreatenewliteralthenapply*tothenewliteralintcreatedLiteralStateNum=currstate;//LocationofthecreatedLiteraladdStateFSMlist.getstartOfTermNumber.symbol,currstate1,currstate1;//CreatesidenticalliteralassavedNextStatepointStateToCurrentstartOfTermNumber;//pointpreviousliteraltothenewbranchstateaddBranchStatecreatedLiteralStateNum,currstate1;//Addbranchstate,pointingtotheterm,andtotheitempastitstartOfTermalreadyispointingtothisbranchnextChar;}returnstartOfTermNumber;//Returnsthefactorlocationforthestate-usedinnothingelse}publicintfactor//Consumesaliteral-i.e.itcanbeassumedonreturnthenextchariseitheranoperatororanexpressiontoconcatenate{intstartOfFactor=currstate;ifnextChar>=regexpattern.lengthreturnstartOfFactor;ifisVocabregexpatternnextChar{startOfFactor=currstate;addStateregexpatternnextChar,currstate1,currstate1;nextChar;//Consumeafactor}elseifregexpatternnextChar==''{nextChar;//ConsumebracketstartOfFactor=expression;//ProcesstheinternalsoftheifregexpatternnextChar==''//IftheverynextcharisNOTaclosebracket,thentheparsingfailsnextChar;//Consumethe''elseerror;}elseifregexpatternnextChar=='.'{startOfFactor=currstate;addState'\t',currstate1,currstate1;//AddwildcardnextChar;//Consumeafactor}elseerror;returnstartOfFactor;}publicbooleanisVocabchars{//Checksifthevariableisaliteralwithinthescopeoftheproject-i.e.acceptableasciiifs=='\\'{nextChar;//Programwillworkwithnextvalueasliteralreturntrue;}return!specialChars.containss;}////----------------------STATEFUNCTIONS-----------------------//publicvoidrepointAllToCurrentintoldTarget,intsearchStart{//Repointallvaluespointingtospecificstatetoanother-doesnotapplytovaluesthatoccurbeforethesearchstartforinti=searchStart;i<oldTarget;i{//OnlyrepointthingsthathaveoccurredbeforetheoldstateifFSMlist.geti.n1==oldTarget{FSMlist.geti.n1=currstate;}ifFSMlist.geti.n2==oldTarget{FSMlist.geti.n2=currstate;}}}publicvoidpointStateToCurrentintstateIndex{//repointtheinputFSMtothecurrentstate,butdoesitdifferentlybasedonthetypeofstateifObjects.equalsFSMlist.getstateIndex.n1,FSMlist.getstateIndex.n2{FSMlist.getstateIndex.n1=currstate;}FSMlist.getstateIndex.n2=currstate;}publicvoidaddStatecharsym,intn1,intn2{FSMlist.addnewStatesym,n1,n2;currstate;}publicvoidaddBranchStateintn1,intn2{FSMlist.addnewState'\0',n1,n2;currstate;}publicvoidupdateStateintstate,charsym,intn1,intn2{FSMlist.setstate,newStatesym,n1,n2;}////---------------------ERRORFUNCTION--------------------//publicvoiderror{System.out.println;System.exit1;}}//StateclassholdsalloftheindividualinfooftheStatesinaFSMclassState{charsymbol;intn1;intn2;//UsedtoholdtheStatevaluesastheyareparsedforthecompiler,canalsobeusedbythesearchpublicStatecharsymbol,intn1,intn2{this.symbol=symbol;this.n1=n1;this.n2=n2;}}