packagecom.skwangles;importjava.util.ArrayList;importjava.util.Ob
jects;//AlexanderStokes-1578409&RowanThorley-1560315//AlexanderDev
elopedthis//--Factorisaliteral,termissomethingthatcouldbepartofawholei.
e.abisatermofab/2//--StateorFSMmeansalabellediteminanFSMtablethathas1.astate,2
.twonextstates-n1,n2-pointstothenextindexinthewholemodelpublicclassREcompil
e{intcurrstate=0;//Statenumberstartsat0,intnextChar=0;charregexpattern;//Hold
sallthecharstobeparsed/compiledArrayList<State>FSMlist=newArrayList<>;Strings
pecialChars=;//AllspecialcharsStringwildcardPrintoStringbranchStatePrintout=;
publicstaticvoidmainStringargs{Stringregex=args0;//Readsintheregexpatterninto
aneasilyparse-ableset.REcompilecompile=newREcompile;compile.parseregex;}public
voidparseStringregex{regexpattern=changeSquareToSlashregex.toCharArray;addStat
e'\0',1,1;//Startingstateexpression;ifnextChar<regexpattern.lengtherror;//Whol
epatternwasnotparsedaddState'\0',-1,-1;//Finishingstatepointingbacktostart-Can
beremoveorpointedto-1
forinti=0;i<FSMlist .size;i{Statestate=FSMlist.geti;System.out.print
lnistate.n1state.n2state.symbol=='\0'?branchStatePrintout:state.sy
mbol=='\t'?wildcardPrintout:state.symbol;}}publicbooleanisBracketS
lashedintb,Stringregex{intevenOrOdd=0;whileb>0&&regex.charAtb-1=='\
\'{evenOrOdd;b--;}returnevenOrOdd% 2==1;//Ifodd,thereisa\forthe,ifev
en-alltheslashescanceleachother}publicStringchangeSquareToSlashStri
ngregex{//replacestheinaregexwiththeabcversionintfromIndex=0;whilere
gex.indexOf,fromIndex!=-1{intfirstBracket=regex.indexOf,fromIndex;ifi
sBracketSlashedfirstBracket,regex{fromIndex=firstBracket1;continue;}//
Iftheisinterpretedasaliteral,skipitandadvancethe'searchfrom'indexintcl
osingBracket=regex.indexOf,fromIndex2;//Startsearchfromatleast2pastthet
oexcludethefirstliteralCouldbeaifclosingBracket==-1closingBracket-first
Bracket<=1{//Theremustbeaotherwisethereareunmatchedbracketsandtheremustb
eatleast2characterstobevaliderror;}fromIndex=closingBracket;//Narrowthes
earchregex=regex.substring0,firstBracket cutregex.substringclosingBracket
1;//Readformattedstringbacktoinput}returnregex;}////-----------------PARS
EFUNCTIONS-----------//publicintexpression{intprevState=currstate-1;intsta
rtofExpression=concatenation;ifnextChar>=regexpattern.lengthreturnstartofE
xpression;//ReturniffinishedifregexpatternnextChar==''{nextChar;//Consumeif
nextChar>=regexpattern.length!isVocabregexpatternnextChar&&regexpatternnext
Char!='.'&&regexpatternnextChar!=''error;//Makesureafullexpressionispossibl
epointStateToCurrentprevState;//Pointprevioustothebranchstateabouttobecreat
edintheldBranch=currstate;addBranchState0,0;//placeholderintnextExpressionSt
art=expression;repointAllToCurrentheldBranch,prevState1;//Repointallitemspoi
ntingtoheldexcludingprevstateupdate StateheldBranch,'\0',startofExpression,ne
xtExpressionStart;//pointStateToCurrentheldBranch-1;//PointstatejustBEFOREth
ebranchtotheexitstatestartofExpression=heldBranch;//Branchisnowthestartofthis
expression}returnstartofExpression;//Returnsthepointertothestartofthisparticu
larexpression}publicintconcatenation{intstartOfConcat=term;ifnextChar>=regexp
attern.lengthreturnstartOfConcat;//Returniffinishedif!specialChars.containsre
gexpatternnextCharregexpatternnextChar==''regexpatternnextChar=='.'concatenat
on;//Lookahead,witho utadvancinganypossiblereturnstartOfConcat;}publicintterm{//
nextCharisusedto'consume'theoperator//currstateisusedtoprogressforwardintheSta
testableintprevState=currstate-1;intstartOfTermNumber=factor;ifnextChar>=regexp
attern.lengthreturnstartOfTermNumber;ifregexpatternnextChar=='*'{pointStateToCu
rrentprevState;//repointtobranchstateaddBranchStatestartOfTermNumber,currstate1
;//Addbranchstate,pointingtotheterm,andtotheitempastitt1alreadyispointingtothisb
ranchnextChar;startOfTermNumber=currstate-1;//BranchisnowthestartoftheTerm}elseif
regexpatternnextChar=='?'{pointStateToCurrentprevState;//pointprevioustothenewbra
nchstateaddBranchStatestartOfTermNumber,currstate1;//Addbranchstate,pointingtothe
term,andtotheitempastitnextChar;repointAllToCurrentcurrstate-1,prevState1;//Repoint
anyitemsEXCLUDINGtheprevstate,tothenewexit}elseifregexpatternnextChar==''{//aisequa
ltoaa*-firstcreatenewliteralthenapply*tothenewliteralintcreatedLiteralStateNum=currstate
;//LocationofthecreatedLiteraladdStateFSMlist.getstartOfTermNumber.symbol,currstate1,cur
rstate1;//CreatesidenticalliteralassavedNextStatepointStateToCurrentstartOfTermNumber;//p
ointpreviousliteraltothenewbranchstateaddBranchStatecreatedLiteralStateNum,currstate1;//Add
branchstate,pointingtotheterm,andtotheitempastitstartOfTermalreadyispointingtothisbranchnex
tChar;}returnstartOfTermNumber;//Returnsthefactorlocationforthestate-usedinnothingel
se}publicintfactor//Consumesaliteral-i.e.itcanbeassumedonreturnthenextchariseith
eranoperatororanexpressiontoconcatenate{intstartOfFactor=currstate;ifnextCh
ar>=regexpattern.lengthreturnstartOfFactor;ifisVocabregexpatternnextChar{sta
rtOfFactor=currstate;addStateregexpatternnextChar,currstate1,currstate1;nextChar;
//Consumeafactor}elseifregexpatternnextChar==''{nextChar;//ConsumebracketstartOfFactor=ex
pression;//ProcesstheinternalsoftheifregexpatternnextChar==''//IftheverynextcharisNOTacloseb
racket,thentheparsingfailsnextChar;//Consumethe''elseerror;}elseifregexpatternnextChar==
'.'{startOfFactor=currstate;addState'\t',currstate1,currstate1;//AddwildcardnextChar;//Consume
afactor}elseerror;returnstartOfFactor;}publicbooleanisVocabchars{//Checksifthevariableis
aliteralwithinthescopeoftheproject-i.e.acceptableasciiifs=='\\'{nextChar;//Programwillworkwith
nextvalueasliteralreturntrue;}return!specialChars.containss;}////----------------------
STATEFUNCTIONS-----------------------//publicvoidrepointAllToCurrentintoldTarget,intsearchStart{
//Repointallvaluespointingtospecificstatetoanother-doesnotapplytovaluesthatoccurbeforethesearc
hstartforinti=searchStart;i<oldTarget;i{//OnlyrepointthingsthathaveoccurredbeforetheoldstateifF
SMlist.geti.n1==oldTarget{FSMlist.geti.n1=currstate;}ifFSMlist.geti.n2==oldTarget{FSMlist.geti
.n2=currstate;}}}publicvoidpointStateToCurrentintstateIndex{//repointtheinputFSMtothecurrentst
ate,butdoesitdifferentlybasedonthetypeofstateifObjects.equalsFSMlist.getstateIndex.n1,FSMlist
.getstateIndex.n2{FSMlist.getstateIndex.n1=currstate;}FSMlist.getstateIndex.n2=currstate;}pub
licvoidaddStatecharsym,intn1,intn2{FSMlist.addnewStatesym,n1,n2;currstate;}publicvoidaddBranc
hStateintn1,intn2{FSMlist.addnewState'\0',n1,n2;currstate;}publicvoidupdateStateintstate,
,intn1,intn2{FSMlist.setstate,newStatesym,n1,n2;}////---------------------ERRORFUNCTION-------
-------------//publicvoiderror{System.out.println;System.exit1;}}//Stateclassholdsalloftheind
ividualinfooftheStatesinaFSMclassState{charsymbol;intn1;intn2;//UsedtoholdtheStatevaluesasthey
areparsedforthecompiler,canalsobeusedbythesearchpublicStatecharsymbol,intn1,intn2{this.symbol=
symbol;this.n1=n1;this.n2=n2;}}